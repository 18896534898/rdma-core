.TH SRP_DAEMON 1 "September 5, 2006" "OpenFabrics" "USER COMMANDS"

.SH NAME
srp_daemon \- Discovers SRP targets in an InfiniBand Fabric

.SH SYNOPSIS
.B srp_daemon [-vVcaeon] [-d \fIumad-device\fR | -i \fIinfiniband-device\fR [-p \fIport-num\fR]] [-t \fItimoeout(ms)\fR] [-r \fIretries\fR] [-R \fIRescan-time\fR]


.SH DESCRIPTION
.PP
Discovers and connects to InfiniBand SCSI RDMA Protocol (SRP) targets in an IB fabric.

Each srp_daemon instance operates on one local port. Upon boot it performs a full rescan of the fabric then waits for an srp_daemon event. An srp_daemon event can be a join of a new machine to the fabric, a change in the capabilities of a machine, an SA change, or an expiration of a predefined timeout.

When a new machine joins the fabric, srp_daemon checks if it is a target. When there is a change of capabilities, srp_daemon checks if the machine has turned into a target. When there is an SA change or a timeout expiration, srp_daemon performs a full rescan of the fabric.

For each target srp_daemon finds, it checks if it is already connected to the local port. If it is not connected, srp_daemon can either print the target details or connect to it.

.SH OPTIONS

.PP
.TP
\fB\-v\fR
Print more verbose output
.TP
\fB\-V\fR
Print even more verbose output (debug mode)
.TP
\fB\-i\fR \fIinfiniband-device\fR
Work on \fIinfiniband-device\fR. This option should not be used with -d.
.TP
\fB\-p\fR \fIport-num\fR
Work on port \fIport-num\fR (default 1). This option must be used with -i and should not be used with -d.
.TP
\fB\-d\fR \fIumad-device\fR
Use device file \fIumad-device\fR (default /dev/infiniband/umad0) This option should not be used with -i or -p.
.TP
\fB\-c\fR
Generate output suitable for piping directly to a
/sys/class/infiniband_srp/srp\-<device>\-<port>/add_target file. 
.TP
\fB\-a\fR
Prints all the targets in the fabric, not only targets that are not connected through the local port. (The same as ibsrpdm.)
.TP
\fB\-e\fR
Execute the connection command, i.e., make the connection to the target.
.TP
\fB\-o\fR
Perform only one rescan and exit. (The same as ibsrpdm.)
.TP
\fB\-R\fR \fIRescan-time\fR
Force a complete rescan every \fIRescan-time\fR seconds. If -R is not specified, no timeout rescans will be performed.
.TP
\fB\-t\fR \fItimoeout\fR
Use timeout of \fItimoeout\fR msec for MAD responses (default: 5 sec).
.TP
\fB\-r\fR \fIretries\fR
Perform \fIretries\fR retries on each send to MAD (default: 3 retries).
.TP
\fB\-n\fR
New format - use also initiator_ext in the connection command.

.SH EXAMPLES
srp_daemon -e -i mthca0 -p 1 -R 60 (Connects to the targets accessible through port 1 of mthca0. Performs a complete rescan every minute)
srp_daemon -o -c -a		   (Prints the connection commands for the targets in the fabric and exits - similar to ibsrpdm)

.SH AUTHORS
.TP
Roland Dreier
.RI < rolandd@cisco.com >
.TP
Ishai Rabinovitz
.RI < ishai@mellanox.co.il >
